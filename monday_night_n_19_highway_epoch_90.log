Using gpu device 0: GRID K520 (CNMeM is enabled)
/home/ubuntu/.local/lib/python2.7/site-packages/theano/tensor/signal/downsample.py:5: UserWarning: downsample module has been moved to the pool module.
  warnings.warn("downsample module has been moved to the pool module.")
Loading data...
loading training data for synset 20 / 100
loading training data for synset 40 / 100
loading training data for synset 60 / 100
loading training data for synset 80 / 100
loading training data for synset 100 / 100
Building model and compiling functions...
Highway Net
number of parameters in model: 4235172
Starting training...
Epoch 1 of 90 took 6.617m
  training loss:		4.498227
  validation loss:		3.979922
  validation accuracy:		12.90 %
 top 5 validation accuracy:		36.82 %
Epoch 2 of 90 took 6.615m
  training loss:		3.720414
  validation loss:		3.241548
  validation accuracy:		22.38 %
 top 5 validation accuracy:		50.08 %
Epoch 3 of 90 took 6.615m
  training loss:		3.294431
  validation loss:		2.807672
  validation accuracy:		30.62 %
 top 5 validation accuracy:		60.10 %
Epoch 4 of 90 took 6.608m
  training loss:		2.997149
  validation loss:		2.587506
  validation accuracy:		35.52 %
 top 5 validation accuracy:		65.56 %
Epoch 5 of 90 took 6.595m
  training loss:		2.781864
  validation loss:		2.475676
  validation accuracy:		37.66 %
 top 5 validation accuracy:		67.80 %
Epoch 6 of 90 took 6.595m
  training loss:		2.603415
  validation loss:		2.384561
  validation accuracy:		40.72 %
 top 5 validation accuracy:		69.52 %
Epoch 7 of 90 took 6.597m
  training loss:		2.453595
  validation loss:		2.329869
  validation accuracy:		42.92 %
 top 5 validation accuracy:		71.02 %
Epoch 8 of 90 took 6.596m
  training loss:		2.336376
  validation loss:		2.157309
  validation accuracy:		47.22 %
 top 5 validation accuracy:		74.98 %
Epoch 9 of 90 took 6.599m
  training loss:		2.237880
  validation loss:		2.118708
  validation accuracy:		46.58 %
 top 5 validation accuracy:		74.90 %
Epoch 10 of 90 took 6.599m
  training loss:		2.158594
  validation loss:		2.310048
  validation accuracy:		44.08 %
 top 5 validation accuracy:		72.24 %
Epoch 11 of 90 took 6.596m
  training loss:		2.090377
  validation loss:		2.123913
  validation accuracy:		48.98 %
 top 5 validation accuracy:		75.50 %
Epoch 12 of 90 took 6.594m
  training loss:		2.026103
  validation loss:		2.172258
  validation accuracy:		48.42 %
 top 5 validation accuracy:		76.10 %
Epoch 13 of 90 took 6.594m
  training loss:		1.979508
  validation loss:		2.258576
  validation accuracy:		47.78 %
 top 5 validation accuracy:		74.72 %
Epoch 14 of 90 took 6.596m
  training loss:		1.931206
  validation loss:		2.088621
  validation accuracy:		50.68 %
 top 5 validation accuracy:		76.62 %
Epoch 15 of 90 took 6.595m
  training loss:		1.904093
  validation loss:		2.091032
  validation accuracy:		50.34 %
 top 5 validation accuracy:		77.66 %
Epoch 16 of 90 took 6.595m
  training loss:		1.875647
  validation loss:		2.155419
  validation accuracy:		49.28 %
 top 5 validation accuracy:		75.40 %
Epoch 17 of 90 took 6.595m
  training loss:		1.844530
  validation loss:		2.259089
  validation accuracy:		48.50 %
 top 5 validation accuracy:		75.74 %
Epoch 18 of 90 took 6.595m
  training loss:		1.821702
  validation loss:		2.188557
  validation accuracy:		50.14 %
 top 5 validation accuracy:		76.06 %
Epoch 19 of 90 took 6.595m
  training loss:		1.799485
  validation loss:		2.209159
  validation accuracy:		50.46 %
 top 5 validation accuracy:		76.90 %
Epoch 20 of 90 took 6.595m
  training loss:		1.784475
  validation loss:		2.315766
  validation accuracy:		49.34 %
 top 5 validation accuracy:		76.78 %
Epoch 21 of 90 took 6.595m
  training loss:		1.760859
  validation loss:		2.215935
  validation accuracy:		49.64 %
 top 5 validation accuracy:		76.82 %
Epoch 22 of 90 took 6.594m
  training loss:		1.749144
  validation loss:		2.249341
  validation accuracy:		49.60 %
 top 5 validation accuracy:		77.04 %
Epoch 23 of 90 took 6.597m
  training loss:		1.752666
  validation loss:		2.349384
  validation accuracy:		50.32 %
 top 5 validation accuracy:		76.06 %
Epoch 24 of 90 took 6.596m
  training loss:		1.736328
  validation loss:		2.907783
  validation accuracy:		43.06 %
 top 5 validation accuracy:		70.28 %
Epoch 25 of 90 took 6.599m
  training loss:		1.744442
  validation loss:		2.570033
  validation accuracy:		47.90 %
 top 5 validation accuracy:		75.40 %
Epoch 26 of 90 took 6.599m
  training loss:		1.707990
  validation loss:		2.449248
  validation accuracy:		50.42 %
 top 5 validation accuracy:		76.62 %
Epoch 27 of 90 took 6.598m
  training loss:		1.690044
  validation loss:		2.662729
  validation accuracy:		48.60 %
 top 5 validation accuracy:		75.82 %
Epoch 28 of 90 took 6.597m
  training loss:		1.704668
  validation loss:		2.575248
  validation accuracy:		47.90 %
 top 5 validation accuracy:		74.00 %
Epoch 29 of 90 took 6.599m
  training loss:		1.708726
  validation loss:		2.374272
  validation accuracy:		51.00 %
 top 5 validation accuracy:		77.06 %
Epoch 30 of 90 took 6.600m
  training loss:		1.696553
  validation loss:		2.484033
  validation accuracy:		50.88 %
 top 5 validation accuracy:		76.94 %
Epoch 31 of 90 took 6.601m
  training loss:		1.679547
  validation loss:		2.694958
  validation accuracy:		48.40 %
 top 5 validation accuracy:		74.78 %
Epoch 32 of 90 took 6.603m
  training loss:		1.695809
  validation loss:		2.380006
  validation accuracy:		51.14 %
 top 5 validation accuracy:		75.74 %
Epoch 33 of 90 took 6.600m
  training loss:		1.689360
  validation loss:		2.849202
  validation accuracy:		45.32 %
 top 5 validation accuracy:		72.40 %
Epoch 34 of 90 took 6.595m
  training loss:		1.674389
  validation loss:		3.028794
  validation accuracy:		44.64 %
 top 5 validation accuracy:		72.02 %
Epoch 35 of 90 took 6.595m
  training loss:		1.684175
  validation loss:		2.485792
  validation accuracy:		49.92 %
 top 5 validation accuracy:		76.58 %
Epoch 36 of 90 took 6.594m
  training loss:		1.667396
  validation loss:		2.666267
  validation accuracy:		49.40 %
 top 5 validation accuracy:		76.10 %
Epoch 37 of 90 took 6.595m
  training loss:		1.648024
  validation loss:		3.104009
  validation accuracy:		45.16 %
 top 5 validation accuracy:		72.18 %
Epoch 38 of 90 took 6.595m
  training loss:		1.665409
  validation loss:		2.426155
  validation accuracy:		50.78 %
 top 5 validation accuracy:		76.36 %
Epoch 39 of 90 took 6.595m
  training loss:		1.645796
  validation loss:		2.778792
  validation accuracy:		48.16 %
 top 5 validation accuracy:		73.76 %
Epoch 40 of 90 took 6.595m
  training loss:		1.647431
  validation loss:		2.610107
  validation accuracy:		49.72 %
 top 5 validation accuracy:		76.56 %
New LR:0.010000000149
Epoch 41 of 90 took 6.594m
  training loss:		1.414806
  validation loss:		1.789586
  validation accuracy:		60.78 %
 top 5 validation accuracy:		83.82 %
Epoch 42 of 90 took 6.595m
  training loss:		1.260921
  validation loss:		1.772287
  validation accuracy:		61.18 %
 top 5 validation accuracy:		84.08 %
Epoch 43 of 90 took 6.595m
  training loss:		1.220277
  validation loss:		1.769342
  validation accuracy:		61.40 %
 top 5 validation accuracy:		84.12 %
Epoch 44 of 90 took 6.595m
  training loss:		1.191076
  validation loss:		1.770311
  validation accuracy:		61.90 %
 top 5 validation accuracy:		84.38 %
Epoch 45 of 90 took 6.594m
  training loss:		1.168181
  validation loss:		1.763637
  validation accuracy:		61.94 %
 top 5 validation accuracy:		84.16 %
Epoch 46 of 90 took 6.595m
  training loss:		1.146291
  validation loss:		1.760323
  validation accuracy:		61.90 %
 top 5 validation accuracy:		84.42 %
Epoch 47 of 90 took 6.595m
  training loss:		1.128666
  validation loss:		1.759389
  validation accuracy:		62.26 %
 top 5 validation accuracy:		84.40 %
Epoch 48 of 90 took 6.595m
  training loss:		1.109425
  validation loss:		1.759254
  validation accuracy:		62.34 %
 top 5 validation accuracy:		84.18 %
Epoch 49 of 90 took 6.596m
  training loss:		1.091867
  validation loss:		1.759822
  validation accuracy:		62.44 %
 top 5 validation accuracy:		84.46 %
Epoch 50 of 90 took 6.595m
  training loss:		1.076390
  validation loss:		1.761149
  validation accuracy:		62.20 %
 top 5 validation accuracy:		84.38 %
Epoch 51 of 90 took 6.595m
  training loss:		1.059480
  validation loss:		1.758571
  validation accuracy:		62.22 %
 top 5 validation accuracy:		84.40 %
Epoch 52 of 90 took 6.595m
  training loss:		1.044434
  validation loss:		1.754504
  validation accuracy:		62.12 %
 top 5 validation accuracy:		84.06 %
Epoch 53 of 90 took 6.595m
  training loss:		1.029641
  validation loss:		1.758642
  validation accuracy:		62.34 %
 top 5 validation accuracy:		84.04 %
Epoch 54 of 90 took 6.594m
  training loss:		1.014134
  validation loss:		1.750478
  validation accuracy:		62.44 %
 top 5 validation accuracy:		84.08 %
Epoch 55 of 90 took 6.595m
  training loss:		0.999805
  validation loss:		1.752425
  validation accuracy:		62.12 %
 top 5 validation accuracy:		84.38 %
Epoch 56 of 90 took 6.595m
  training loss:		0.986182
  validation loss:		1.750526
  validation accuracy:		62.26 %
 top 5 validation accuracy:		84.16 %
Epoch 57 of 90 took 6.595m
  training loss:		0.972396
  validation loss:		1.745871
  validation accuracy:		62.66 %
 top 5 validation accuracy:		84.06 %
Epoch 58 of 90 took 6.595m
  training loss:		0.959122
  validation loss:		1.745472
  validation accuracy:		62.26 %
 top 5 validation accuracy:		84.12 %
Epoch 59 of 90 took 6.594m
  training loss:		0.945337
  validation loss:		1.733891
  validation accuracy:		62.70 %
 top 5 validation accuracy:		84.08 %
Epoch 60 of 90 took 6.594m
  training loss:		0.932314
  validation loss:		1.730193
  validation accuracy:		62.62 %
 top 5 validation accuracy:		84.10 %
Epoch 61 of 90 took 6.596m
  training loss:		0.918958
  validation loss:		1.731647
  validation accuracy:		62.56 %
 top 5 validation accuracy:		84.32 %
Epoch 62 of 90 took 6.596m
  training loss:		0.906373
  validation loss:		1.730520
  validation accuracy:		62.04 %
 top 5 validation accuracy:		84.00 %
Epoch 63 of 90 took 6.595m
  training loss:		0.894234
  validation loss:		1.722020
  validation accuracy:		62.26 %
 top 5 validation accuracy:		84.20 %
Epoch 64 of 90 took 6.595m
  training loss:		0.882432
  validation loss:		1.721885
  validation accuracy:		62.42 %
 top 5 validation accuracy:		84.08 %
Epoch 65 of 90 took 6.595m
  training loss:		0.869981
  validation loss:		1.720387
  validation accuracy:		62.10 %
 top 5 validation accuracy:		84.36 %
Epoch 66 of 90 took 6.595m
  training loss:		0.858485
  validation loss:		1.712287
  validation accuracy:		62.32 %
 top 5 validation accuracy:		84.08 %
Epoch 67 of 90 took 6.595m
  training loss:		0.846869
  validation loss:		1.713161
  validation accuracy:		62.58 %
 top 5 validation accuracy:		84.30 %
Epoch 68 of 90 took 6.595m
  training loss:		0.835513
  validation loss:		1.713861
  validation accuracy:		62.36 %
 top 5 validation accuracy:		84.12 %
Epoch 69 of 90 took 6.595m
  training loss:		0.824677
  validation loss:		1.709245
  validation accuracy:		62.62 %
 top 5 validation accuracy:		84.16 %
Epoch 70 of 90 took 6.595m
  training loss:		0.813317
  validation loss:		1.707836
  validation accuracy:		62.60 %
 top 5 validation accuracy:		84.26 %
New LR:0.000999999977648
Epoch 71 of 90 took 6.595m
  training loss:		0.806558
  validation loss:		1.707897
  validation accuracy:		62.60 %
 top 5 validation accuracy:		84.18 %
Epoch 72 of 90 took 6.595m
  training loss:		0.804996
  validation loss:		1.705271
  validation accuracy:		62.48 %
 top 5 validation accuracy:		84.14 %
Epoch 73 of 90 took 6.595m
  training loss:		0.803828
  validation loss:		1.704143
  validation accuracy:		62.36 %
 top 5 validation accuracy:		84.28 %
Epoch 74 of 90 took 6.595m
  training loss:		0.803117
  validation loss:		1.698937
  validation accuracy:		62.40 %
 top 5 validation accuracy:		84.30 %
Epoch 75 of 90 took 6.595m
  training loss:		0.801612
  validation loss:		1.705479
  validation accuracy:		62.54 %
 top 5 validation accuracy:		84.28 %
Epoch 76 of 90 took 6.595m
  training loss:		0.800609
  validation loss:		1.703633
  validation accuracy:		62.58 %
 top 5 validation accuracy:		84.12 %
Epoch 77 of 90 took 6.595m
  training loss:		0.799646
  validation loss:		1.703370
  validation accuracy:		62.38 %
 top 5 validation accuracy:		84.14 %
Epoch 78 of 90 took 6.594m
  training loss:		0.798654
  validation loss:		1.698760
  validation accuracy:		62.62 %
 top 5 validation accuracy:		84.20 %
Epoch 79 of 90 took 6.595m
  training loss:		0.797489
  validation loss:		1.708353
  validation accuracy:		62.64 %
 top 5 validation accuracy:		84.24 %
Epoch 80 of 90 took 6.594m
  training loss:		0.796389
  validation loss:		1.699789
  validation accuracy:		62.70 %
 top 5 validation accuracy:		84.18 %
Epoch 81 of 90 took 6.596m
  training loss:		0.795384
  validation loss:		1.698645
  validation accuracy:		62.32 %
 top 5 validation accuracy:		84.12 %
Epoch 82 of 90 took 6.594m
  training loss:		0.794144
  validation loss:		1.701764
  validation accuracy:		62.66 %
 top 5 validation accuracy:		84.30 %
Epoch 83 of 90 took 6.595m
  training loss:		0.793144
  validation loss:		1.700619
  validation accuracy:		62.80 %
 top 5 validation accuracy:		84.16 %
Epoch 84 of 90 took 6.595m
  training loss:		0.791972
  validation loss:		1.704881
  validation accuracy:		62.54 %
 top 5 validation accuracy:		84.34 %
Epoch 85 of 90 took 6.597m
  training loss:		0.791097
  validation loss:		1.700511
  validation accuracy:		62.74 %
 top 5 validation accuracy:		84.26 %
Epoch 86 of 90 took 6.596m
  training loss:		0.789788
  validation loss:		1.698568
  validation accuracy:		62.50 %
 top 5 validation accuracy:		84.42 %
Epoch 87 of 90 took 6.600m
  training loss:		0.789293
  validation loss:		1.698265
  validation accuracy:		62.58 %
 top 5 validation accuracy:		84.26 %
Epoch 88 of 90 took 6.595m
  training loss:		0.787996
  validation loss:		1.708872
  validation accuracy:		62.54 %
 top 5 validation accuracy:		84.02 %
Epoch 89 of 90 took 6.594m
  training loss:		0.786505
  validation loss:		1.696171
  validation accuracy:		62.50 %
 top 5 validation accuracy:		84.34 %
Epoch 90 of 90 took 6.596m
  training loss:		0.785700
  validation loss:		1.699730
  validation accuracy:		62.50 %
 top 5 validation accuracy:		84.30 %
Total training time: 594.918m
Final results:
  test loss:			1.700327
  test accuracy:		62.48 %
