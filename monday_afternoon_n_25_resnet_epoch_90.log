Using gpu device 0: GRID K520 (CNMeM is enabled)
/home/ubuntu/.local/lib/python2.7/site-packages/theano/tensor/signal/downsample.py:5: UserWarning: downsample module has been moved to the pool module.
  warnings.warn("downsample module has been moved to the pool module.")
Loading data...
loading training data for synset 20 / 100
loading training data for synset 40 / 100
loading training data for synset 60 / 100
loading training data for synset 80 / 100
loading training data for synset 100 / 100
Building model and compiling functions...
ResNet
number of parameters in model: 10163108
Starting training...
Epoch 1 of 90 took 8.973m
  training loss:		5.167942
  validation loss:		3.679569
  validation accuracy:		17.70 %
 top 5 validation accuracy:		42.38 %
Epoch 2 of 90 took 8.978m
  training loss:		4.335113
  validation loss:		3.208784
  validation accuracy:		23.26 %
 top 5 validation accuracy:		51.58 %
Epoch 3 of 90 took 8.978m
  training loss:		3.900443
  validation loss:		2.912474
  validation accuracy:		29.56 %
 top 5 validation accuracy:		57.80 %
Epoch 4 of 90 took 8.976m
  training loss:		3.574992
  validation loss:		2.759114
  validation accuracy:		34.14 %
 top 5 validation accuracy:		62.66 %
Epoch 5 of 90 took 8.975m
  training loss:		3.323777
  validation loss:		2.774358
  validation accuracy:		34.36 %
 top 5 validation accuracy:		60.88 %
Epoch 6 of 90 took 8.976m
  training loss:		3.096579
  validation loss:		2.426654
  validation accuracy:		40.24 %
 top 5 validation accuracy:		68.76 %
Epoch 7 of 90 took 8.978m
  training loss:		2.918023
  validation loss:		2.368419
  validation accuracy:		41.98 %
 top 5 validation accuracy:		69.68 %
Epoch 8 of 90 took 8.979m
  training loss:		2.747519
  validation loss:		2.355189
  validation accuracy:		42.62 %
 top 5 validation accuracy:		70.58 %
Epoch 9 of 90 took 8.977m
  training loss:		2.603240
  validation loss:		2.234254
  validation accuracy:		44.48 %
 top 5 validation accuracy:		72.02 %
Epoch 10 of 90 took 8.980m
  training loss:		2.498619
  validation loss:		2.137931
  validation accuracy:		46.64 %
 top 5 validation accuracy:		74.18 %
Epoch 11 of 90 took 8.979m
  training loss:		2.416201
  validation loss:		2.114048
  validation accuracy:		47.82 %
 top 5 validation accuracy:		74.96 %
Epoch 12 of 90 took 8.979m
  training loss:		2.335758
  validation loss:		2.253995
  validation accuracy:		45.06 %
 top 5 validation accuracy:		72.98 %
Epoch 13 of 90 took 8.982m
  training loss:		2.272010
  validation loss:		2.203457
  validation accuracy:		47.44 %
 top 5 validation accuracy:		74.66 %
Epoch 14 of 90 took 8.986m
  training loss:		2.228424
  validation loss:		2.190483
  validation accuracy:		47.28 %
 top 5 validation accuracy:		74.36 %
Epoch 15 of 90 took 8.982m
  training loss:		2.174477
  validation loss:		2.162764
  validation accuracy:		49.06 %
 top 5 validation accuracy:		75.12 %
Epoch 16 of 90 took 8.985m
  training loss:		2.143938
  validation loss:		2.096417
  validation accuracy:		49.78 %
 top 5 validation accuracy:		76.60 %
Epoch 17 of 90 took 8.984m
  training loss:		2.109715
  validation loss:		2.195841
  validation accuracy:		49.08 %
 top 5 validation accuracy:		75.42 %
Epoch 18 of 90 took 8.984m
  training loss:		2.095812
  validation loss:		2.284871
  validation accuracy:		47.26 %
 top 5 validation accuracy:		74.94 %
Epoch 19 of 90 took 8.983m
  training loss:		2.079648
  validation loss:		2.389840
  validation accuracy:		47.50 %
 top 5 validation accuracy:		74.08 %
Epoch 20 of 90 took 8.986m
  training loss:		2.064884
  validation loss:		2.255963
  validation accuracy:		49.50 %
 top 5 validation accuracy:		75.58 %
Epoch 21 of 90 took 8.987m
  training loss:		2.056609
  validation loss:		2.211824
  validation accuracy:		50.12 %
 top 5 validation accuracy:		76.32 %
Epoch 22 of 90 took 8.984m
  training loss:		2.047071
  validation loss:		2.321434
  validation accuracy:		49.82 %
 top 5 validation accuracy:		75.76 %
Epoch 23 of 90 took 8.984m
  training loss:		2.022582
  validation loss:		2.304004
  validation accuracy:		48.66 %
 top 5 validation accuracy:		75.16 %
Epoch 24 of 90 took 8.987m
  training loss:		2.034278
  validation loss:		2.266374
  validation accuracy:		50.88 %
 top 5 validation accuracy:		76.68 %
Epoch 25 of 90 took 8.984m
  training loss:		2.024511
  validation loss:		2.387894
  validation accuracy:		49.40 %
 top 5 validation accuracy:		74.86 %
Epoch 26 of 90 took 8.984m
  training loss:		2.025615
  validation loss:		2.391155
  validation accuracy:		49.24 %
 top 5 validation accuracy:		74.96 %
Epoch 27 of 90 took 8.981m
  training loss:		2.029996
  validation loss:		2.378947
  validation accuracy:		49.44 %
 top 5 validation accuracy:		76.42 %
Epoch 28 of 90 took 8.984m
  training loss:		2.021972
  validation loss:		2.433275
  validation accuracy:		49.10 %
 top 5 validation accuracy:		75.72 %
Epoch 29 of 90 took 8.985m
  training loss:		2.012113
  validation loss:		2.514768
  validation accuracy:		49.94 %
 top 5 validation accuracy:		75.74 %
Epoch 30 of 90 took 8.989m
  training loss:		2.019317
  validation loss:		2.696071
  validation accuracy:		47.02 %
 top 5 validation accuracy:		74.06 %
Epoch 31 of 90 took 8.986m
  training loss:		2.016684
  validation loss:		2.485334
  validation accuracy:		49.28 %
 top 5 validation accuracy:		75.90 %
Epoch 32 of 90 took 8.984m
  training loss:		2.018121
  validation loss:		2.517633
  validation accuracy:		49.24 %
 top 5 validation accuracy:		74.64 %
Epoch 33 of 90 took 8.984m
  training loss:		2.023110
  validation loss:		2.457898
  validation accuracy:		48.20 %
 top 5 validation accuracy:		74.80 %
Epoch 34 of 90 took 8.991m
  training loss:		2.000413
  validation loss:		2.533992
  validation accuracy:		47.42 %
 top 5 validation accuracy:		74.42 %
Epoch 35 of 90 took 8.989m
  training loss:		2.008552
  validation loss:		2.446583
  validation accuracy:		49.72 %
 top 5 validation accuracy:		75.88 %
Epoch 36 of 90 took 8.983m
  training loss:		2.036738
  validation loss:		2.693299
  validation accuracy:		46.98 %
 top 5 validation accuracy:		73.44 %
Epoch 37 of 90 took 8.985m
  training loss:		2.000954
  validation loss:		2.506491
  validation accuracy:		49.60 %
 top 5 validation accuracy:		74.62 %
Epoch 38 of 90 took 8.992m
  training loss:		2.015245
  validation loss:		2.503756
  validation accuracy:		49.12 %
 top 5 validation accuracy:		75.58 %
Epoch 39 of 90 took 8.987m
  training loss:		1.999178
  validation loss:		2.505137
  validation accuracy:		49.58 %
 top 5 validation accuracy:		75.68 %
Epoch 40 of 90 took 8.986m
  training loss:		2.010005
  validation loss:		2.831056
  validation accuracy:		47.36 %
 top 5 validation accuracy:		74.14 %
New LR:0.010000000149
Epoch 41 of 90 took 8.988m
  training loss:		1.714547
  validation loss:		1.978031
  validation accuracy:		58.14 %
 top 5 validation accuracy:		81.02 %
Epoch 42 of 90 took 8.989m
  training loss:		1.523228
  validation loss:		1.955638
  validation accuracy:		58.66 %
 top 5 validation accuracy:		81.78 %
Epoch 43 of 90 took 8.988m
  training loss:		1.469251
  validation loss:		1.967595
  validation accuracy:		58.86 %
 top 5 validation accuracy:		81.94 %
Epoch 44 of 90 took 8.984m
  training loss:		1.432541
  validation loss:		1.976073
  validation accuracy:		59.24 %
 top 5 validation accuracy:		82.26 %
Epoch 45 of 90 took 8.984m
  training loss:		1.401421
  validation loss:		1.981781
  validation accuracy:		59.82 %
 top 5 validation accuracy:		82.12 %
Epoch 46 of 90 took 8.990m
  training loss:		1.374370
  validation loss:		1.994618
  validation accuracy:		59.62 %
 top 5 validation accuracy:		82.36 %
Epoch 47 of 90 took 8.991m
  training loss:		1.349981
  validation loss:		1.996899
  validation accuracy:		59.72 %
 top 5 validation accuracy:		82.46 %
Epoch 48 of 90 took 8.986m
  training loss:		1.327388
  validation loss:		2.006634
  validation accuracy:		59.48 %
 top 5 validation accuracy:		82.22 %
Epoch 49 of 90 took 8.985m
  training loss:		1.306632
  validation loss:		1.999287
  validation accuracy:		59.76 %
 top 5 validation accuracy:		82.40 %
Epoch 50 of 90 took 8.990m
  training loss:		1.284099
  validation loss:		2.015606
  validation accuracy:		59.92 %
 top 5 validation accuracy:		82.04 %
Epoch 51 of 90 took 8.986m
  training loss:		1.264750
  validation loss:		2.010254
  validation accuracy:		59.94 %
 top 5 validation accuracy:		82.56 %
Epoch 52 of 90 took 8.982m
  training loss:		1.245634
  validation loss:		2.019108
  validation accuracy:		60.02 %
 top 5 validation accuracy:		82.60 %
Epoch 53 of 90 took 8.983m
  training loss:		1.226285
  validation loss:		2.017309
  validation accuracy:		60.40 %
 top 5 validation accuracy:		82.48 %
Epoch 54 of 90 took 8.989m
  training loss:		1.207872
  validation loss:		2.025309
  validation accuracy:		60.40 %
 top 5 validation accuracy:		82.54 %
Epoch 55 of 90 took 8.991m
  training loss:		1.188959
  validation loss:		2.014031
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.58 %
Epoch 56 of 90 took 8.983m
  training loss:		1.171649
  validation loss:		2.012948
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.56 %
Epoch 57 of 90 took 8.984m
  training loss:		1.153947
  validation loss:		2.010997
  validation accuracy:		60.02 %
 top 5 validation accuracy:		82.46 %
Epoch 58 of 90 took 8.983m
  training loss:		1.137312
  validation loss:		2.009056
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.38 %
Epoch 59 of 90 took 8.979m
  training loss:		1.120955
  validation loss:		2.012653
  validation accuracy:		60.16 %
 top 5 validation accuracy:		82.64 %
Epoch 60 of 90 took 8.979m
  training loss:		1.103848
  validation loss:		2.013928
  validation accuracy:		60.26 %
 top 5 validation accuracy:		82.30 %
Epoch 61 of 90 took 8.980m
  training loss:		1.087965
  validation loss:		2.012202
  validation accuracy:		60.14 %
 top 5 validation accuracy:		82.46 %
Epoch 62 of 90 took 8.983m
  training loss:		1.071894
  validation loss:		2.007942
  validation accuracy:		60.22 %
 top 5 validation accuracy:		82.42 %
Epoch 63 of 90 took 8.981m
  training loss:		1.056793
  validation loss:		2.002633
  validation accuracy:		60.10 %
 top 5 validation accuracy:		82.30 %
Epoch 64 of 90 took 8.977m
  training loss:		1.041494
  validation loss:		2.000243
  validation accuracy:		60.22 %
 top 5 validation accuracy:		82.54 %
Epoch 65 of 90 took 8.978m
  training loss:		1.025793
  validation loss:		2.002884
  validation accuracy:		60.32 %
 top 5 validation accuracy:		82.34 %
Epoch 66 of 90 took 8.982m
  training loss:		1.011107
  validation loss:		2.004133
  validation accuracy:		60.14 %
 top 5 validation accuracy:		82.42 %
Epoch 67 of 90 took 8.980m
  training loss:		0.996685
  validation loss:		1.995182
  validation accuracy:		59.90 %
 top 5 validation accuracy:		82.14 %
Epoch 68 of 90 took 8.979m
  training loss:		0.982424
  validation loss:		1.987864
  validation accuracy:		60.02 %
 top 5 validation accuracy:		82.40 %
Epoch 69 of 90 took 8.980m
  training loss:		0.968213
  validation loss:		1.981194
  validation accuracy:		60.18 %
 top 5 validation accuracy:		82.42 %
Epoch 70 of 90 took 8.979m
  training loss:		0.954272
  validation loss:		1.987793
  validation accuracy:		60.28 %
 top 5 validation accuracy:		82.10 %
New LR:0.000999999977648
Epoch 71 of 90 took 8.979m
  training loss:		0.946133
  validation loss:		1.978870
  validation accuracy:		60.22 %
 top 5 validation accuracy:		82.26 %
Epoch 72 of 90 took 8.979m
  training loss:		0.944585
  validation loss:		1.984540
  validation accuracy:		60.04 %
 top 5 validation accuracy:		82.18 %
Epoch 73 of 90 took 8.978m
  training loss:		0.942913
  validation loss:		1.973009
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.12 %
Epoch 74 of 90 took 8.982m
  training loss:		0.941822
  validation loss:		1.983865
  validation accuracy:		60.16 %
 top 5 validation accuracy:		82.40 %
Epoch 75 of 90 took 8.979m
  training loss:		0.940136
  validation loss:		1.979234
  validation accuracy:		60.10 %
 top 5 validation accuracy:		82.36 %
Epoch 76 of 90 took 8.979m
  training loss:		0.939132
  validation loss:		1.984821
  validation accuracy:		59.96 %
 top 5 validation accuracy:		82.28 %
Epoch 77 of 90 took 8.980m
  training loss:		0.937211
  validation loss:		1.978821
  validation accuracy:		60.00 %
 top 5 validation accuracy:		82.42 %
Epoch 78 of 90 took 8.979m
  training loss:		0.935938
  validation loss:		1.977931
  validation accuracy:		59.86 %
 top 5 validation accuracy:		82.22 %
Epoch 79 of 90 took 8.981m
  training loss:		0.934735
  validation loss:		1.971366
  validation accuracy:		60.08 %
 top 5 validation accuracy:		82.46 %
Epoch 80 of 90 took 8.984m
  training loss:		0.933012
  validation loss:		1.973252
  validation accuracy:		60.18 %
 top 5 validation accuracy:		82.48 %
Epoch 81 of 90 took 8.983m
  training loss:		0.932003
  validation loss:		1.982076
  validation accuracy:		60.04 %
 top 5 validation accuracy:		82.32 %
Epoch 82 of 90 took 8.988m
  training loss:		0.930308
  validation loss:		1.987368
  validation accuracy:		59.98 %
 top 5 validation accuracy:		82.44 %
Epoch 83 of 90 took 8.985m
  training loss:		0.929165
  validation loss:		1.978116
  validation accuracy:		60.10 %
 top 5 validation accuracy:		82.30 %
Epoch 84 of 90 took 8.985m
  training loss:		0.927787
  validation loss:		1.976259
  validation accuracy:		60.14 %
 top 5 validation accuracy:		82.44 %
Epoch 85 of 90 took 8.982m
  training loss:		0.926334
  validation loss:		1.970397
  validation accuracy:		60.22 %
 top 5 validation accuracy:		82.32 %
Epoch 86 of 90 took 8.985m
  training loss:		0.925161
  validation loss:		1.977772
  validation accuracy:		60.12 %
 top 5 validation accuracy:		82.40 %
Epoch 87 of 90 took 8.985m
  training loss:		0.923787
  validation loss:		1.976212
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.24 %
Epoch 88 of 90 took 8.983m
  training loss:		0.922536
  validation loss:		1.972634
  validation accuracy:		60.08 %
 top 5 validation accuracy:		82.42 %
Epoch 89 of 90 took 8.985m
  training loss:		0.921322
  validation loss:		1.973312
  validation accuracy:		59.96 %
 top 5 validation accuracy:		82.28 %
Epoch 90 of 90 took 8.987m
  training loss:		0.919626
  validation loss:		1.978030
  validation accuracy:		60.06 %
 top 5 validation accuracy:		82.42 %
Total training time: 809.693m
Final results:
  test loss:			1.979788
  test accuracy:		60.06 %
