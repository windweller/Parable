Using gpu device 0: GRID K520 (CNMeM is enabled)
/home/ubuntu/.local/lib/python2.7/site-packages/theano/tensor/signal/downsample.py:5: UserWarning: downsample module has been moved to the pool module.
  warnings.warn("downsample module has been moved to the pool module.")
Loading data...
loading training data for synset 20 / 100
loading training data for synset 40 / 100
loading training data for synset 60 / 100
loading training data for synset 80 / 100
loading training data for synset 100 / 100
Building model and compiling functions...
ResFuse Net
number of parameters in model: 10316068
Starting training...
Epoch 1 of 90 took 9.393m
  training loss:		5.397578
  validation loss:		3.635380
  validation accuracy:		16.42 %
 top 5 validation accuracy:		40.90 %
Epoch 2 of 90 took 9.405m
  training loss:		4.528335
  validation loss:		3.276489
  validation accuracy:		22.70 %
 top 5 validation accuracy:		51.38 %
Epoch 3 of 90 took 9.395m
  training loss:		4.055937
  validation loss:		2.886106
  validation accuracy:		29.52 %
 top 5 validation accuracy:		59.18 %
Epoch 4 of 90 took 9.391m
  training loss:		3.706245
  validation loss:		2.708559
  validation accuracy:		34.12 %
 top 5 validation accuracy:		62.86 %
Epoch 5 of 90 took 9.390m
  training loss:		3.423456
  validation loss:		2.702721
  validation accuracy:		34.70 %
 top 5 validation accuracy:		64.22 %
Epoch 6 of 90 took 9.389m
  training loss:		3.188390
  validation loss:		2.442116
  validation accuracy:		39.36 %
 top 5 validation accuracy:		68.42 %
Epoch 7 of 90 took 9.388m
  training loss:		2.989541
  validation loss:		2.468494
  validation accuracy:		40.04 %
 top 5 validation accuracy:		68.40 %
Epoch 8 of 90 took 9.392m
  training loss:		2.830136
  validation loss:		2.285388
  validation accuracy:		43.58 %
 top 5 validation accuracy:		72.12 %
Epoch 9 of 90 took 9.389m
  training loss:		2.690702
  validation loss:		2.204074
  validation accuracy:		45.24 %
 top 5 validation accuracy:		73.06 %
Epoch 10 of 90 took 9.388m
  training loss:		2.567338
  validation loss:		2.230733
  validation accuracy:		46.26 %
 top 5 validation accuracy:		73.16 %
Epoch 11 of 90 took 9.385m
  training loss:		2.461360
  validation loss:		2.308761
  validation accuracy:		44.22 %
 top 5 validation accuracy:		73.00 %
Epoch 12 of 90 took 9.386m
  training loss:		2.381717
  validation loss:		2.336097
  validation accuracy:		43.62 %
 top 5 validation accuracy:		72.22 %
Epoch 13 of 90 took 9.385m
  training loss:		2.308018
  validation loss:		2.243897
  validation accuracy:		46.26 %
 top 5 validation accuracy:		73.38 %
Epoch 14 of 90 took 9.386m
  training loss:		2.257456
  validation loss:		2.283415
  validation accuracy:		46.48 %
 top 5 validation accuracy:		73.24 %
Epoch 15 of 90 took 9.384m
  training loss:		2.201014
  validation loss:		2.202818
  validation accuracy:		47.74 %
 top 5 validation accuracy:		74.56 %
Epoch 16 of 90 took 9.389m
  training loss:		2.181926
  validation loss:		2.303249
  validation accuracy:		46.48 %
 top 5 validation accuracy:		73.84 %
Epoch 17 of 90 took 9.389m
  training loss:		2.136524
  validation loss:		2.222977
  validation accuracy:		49.36 %
 top 5 validation accuracy:		76.32 %
Epoch 18 of 90 took 9.392m
  training loss:		2.123692
  validation loss:		2.506369
  validation accuracy:		45.74 %
 top 5 validation accuracy:		72.70 %
Epoch 19 of 90 took 9.390m
  training loss:		2.097209
  validation loss:		2.318554
  validation accuracy:		48.22 %
 top 5 validation accuracy:		75.24 %
Epoch 20 of 90 took 9.390m
  training loss:		2.082314
  validation loss:		2.314140
  validation accuracy:		48.46 %
 top 5 validation accuracy:		75.16 %
Epoch 21 of 90 took 9.388m
  training loss:		2.076565
  validation loss:		2.335091
  validation accuracy:		48.28 %
 top 5 validation accuracy:		74.74 %
Epoch 22 of 90 took 9.387m
  training loss:		2.063121
  validation loss:		2.290934
  validation accuracy:		48.06 %
 top 5 validation accuracy:		75.00 %
Epoch 23 of 90 took 9.387m
  training loss:		2.052240
  validation loss:		2.290496
  validation accuracy:		49.90 %
 top 5 validation accuracy:		76.82 %
Epoch 24 of 90 took 9.389m
  training loss:		2.050103
  validation loss:		2.349448
  validation accuracy:		48.54 %
 top 5 validation accuracy:		75.02 %
Epoch 25 of 90 took 9.384m
  training loss:		2.041088
  validation loss:		2.270757
  validation accuracy:		51.06 %
 top 5 validation accuracy:		75.86 %
Epoch 26 of 90 took 9.385m
  training loss:		2.039404
  validation loss:		2.323223
  validation accuracy:		50.16 %
 top 5 validation accuracy:		76.30 %
Epoch 27 of 90 took 9.387m
  training loss:		2.032932
  validation loss:		2.576961
  validation accuracy:		49.06 %
 top 5 validation accuracy:		74.06 %
Epoch 28 of 90 took 9.391m
  training loss:		2.034749
  validation loss:		2.332425
  validation accuracy:		50.58 %
 top 5 validation accuracy:		75.82 %
Epoch 29 of 90 took 9.390m
  training loss:		2.041942
  validation loss:		2.308015
  validation accuracy:		49.86 %
 top 5 validation accuracy:		76.40 %
Epoch 30 of 90 took 9.389m
  training loss:		2.043006
  validation loss:		2.834657
  validation accuracy:		45.12 %
 top 5 validation accuracy:		72.88 %
Epoch 31 of 90 took 9.393m
  training loss:		2.028298
  validation loss:		2.480010
  validation accuracy:		48.74 %
 top 5 validation accuracy:		74.86 %
Epoch 32 of 90 took 9.393m
  training loss:		2.026769
  validation loss:		2.520514
  validation accuracy:		48.06 %
 top 5 validation accuracy:		75.62 %
Epoch 33 of 90 took 9.391m
  training loss:		2.026136
  validation loss:		2.577182
  validation accuracy:		49.62 %
 top 5 validation accuracy:		75.14 %
Epoch 34 of 90 took 9.395m
  training loss:		2.041875
  validation loss:		2.457771
  validation accuracy:		49.22 %
 top 5 validation accuracy:		75.38 %
Epoch 35 of 90 took 9.395m
  training loss:		2.020193
  validation loss:		2.533310
  validation accuracy:		49.36 %
 top 5 validation accuracy:		75.48 %
Epoch 36 of 90 took 9.391m
  training loss:		2.013570
  validation loss:		2.754262
  validation accuracy:		47.08 %
 top 5 validation accuracy:		74.02 %
Epoch 37 of 90 took 9.386m
  training loss:		2.033778
  validation loss:		2.571900
  validation accuracy:		49.46 %
 top 5 validation accuracy:		76.42 %
Epoch 38 of 90 took 9.392m
  training loss:		2.029608
  validation loss:		2.504791
  validation accuracy:		49.36 %
 top 5 validation accuracy:		75.72 %
Epoch 39 of 90 took 9.393m
  training loss:		2.023926
  validation loss:		2.527740
  validation accuracy:		49.96 %
 top 5 validation accuracy:		76.26 %
Epoch 40 of 90 took 9.392m
  training loss:		2.025042
  validation loss:		2.491712
  validation accuracy:		50.00 %
 top 5 validation accuracy:		75.16 %
New LR:0.010000000149
Epoch 41 of 90 took 9.391m
  training loss:		1.722336
  validation loss:		1.922679
  validation accuracy:		58.48 %
 top 5 validation accuracy:		81.48 %
Epoch 42 of 90 took 9.391m
  training loss:		1.538125
  validation loss:		1.902741
  validation accuracy:		59.26 %
 top 5 validation accuracy:		82.50 %
Epoch 43 of 90 took 9.392m
  training loss:		1.478974
  validation loss:		1.904764
  validation accuracy:		59.64 %
 top 5 validation accuracy:		82.66 %
Epoch 44 of 90 took 9.392m
  training loss:		1.445051
  validation loss:		1.913937
  validation accuracy:		59.72 %
 top 5 validation accuracy:		82.56 %
Epoch 45 of 90 took 9.389m
  training loss:		1.412476
  validation loss:		1.915632
  validation accuracy:		60.06 %
 top 5 validation accuracy:		82.52 %
Epoch 46 of 90 took 9.393m
  training loss:		1.385131
  validation loss:		1.930323
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.34 %
Epoch 47 of 90 took 9.392m
  training loss:		1.361049
  validation loss:		1.925458
  validation accuracy:		60.28 %
 top 5 validation accuracy:		82.54 %
Epoch 48 of 90 took 9.391m
  training loss:		1.338140
  validation loss:		1.941389
  validation accuracy:		59.98 %
 top 5 validation accuracy:		82.38 %
Epoch 49 of 90 took 9.391m
  training loss:		1.315897
  validation loss:		1.941400
  validation accuracy:		60.16 %
 top 5 validation accuracy:		82.60 %
Epoch 50 of 90 took 9.392m
  training loss:		1.293776
  validation loss:		1.946768
  validation accuracy:		60.34 %
 top 5 validation accuracy:		82.74 %
Epoch 51 of 90 took 9.394m
  training loss:		1.273795
  validation loss:		1.940778
  validation accuracy:		60.58 %
 top 5 validation accuracy:		82.70 %
Epoch 52 of 90 took 9.392m
  training loss:		1.253627
  validation loss:		1.940959
  validation accuracy:		60.54 %
 top 5 validation accuracy:		82.74 %
Epoch 53 of 90 took 9.390m
  training loss:		1.234663
  validation loss:		1.944034
  validation accuracy:		60.66 %
 top 5 validation accuracy:		82.80 %
Epoch 54 of 90 took 9.392m
  training loss:		1.215992
  validation loss:		1.955342
  validation accuracy:		60.04 %
 top 5 validation accuracy:		82.70 %
Epoch 55 of 90 took 9.392m
  training loss:		1.197849
  validation loss:		1.943746
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.70 %
Epoch 56 of 90 took 9.392m
  training loss:		1.179847
  validation loss:		1.938499
  validation accuracy:		60.76 %
 top 5 validation accuracy:		82.74 %
Epoch 57 of 90 took 9.389m
  training loss:		1.161744
  validation loss:		1.949751
  validation accuracy:		60.28 %
 top 5 validation accuracy:		82.52 %
Epoch 58 of 90 took 9.391m
  training loss:		1.145147
  validation loss:		1.934518
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.70 %
Epoch 59 of 90 took 9.392m
  training loss:		1.127981
  validation loss:		1.937589
  validation accuracy:		60.58 %
 top 5 validation accuracy:		82.54 %
Epoch 60 of 90 took 9.390m
  training loss:		1.111554
  validation loss:		1.943580
  validation accuracy:		60.40 %
 top 5 validation accuracy:		82.52 %
Epoch 61 of 90 took 9.388m
  training loss:		1.095247
  validation loss:		1.941332
  validation accuracy:		60.06 %
 top 5 validation accuracy:		82.32 %
Epoch 62 of 90 took 9.391m
  training loss:		1.079160
  validation loss:		1.935532
  validation accuracy:		60.38 %
 top 5 validation accuracy:		82.32 %
Epoch 63 of 90 took 9.391m
  training loss:		1.063624
  validation loss:		1.939853
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.34 %
Epoch 64 of 90 took 9.386m
  training loss:		1.048188
  validation loss:		1.929770
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.58 %
Epoch 65 of 90 took 9.385m
  training loss:		1.033024
  validation loss:		1.941063
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.48 %
Epoch 66 of 90 took 9.392m
  training loss:		1.018516
  validation loss:		1.932905
  validation accuracy:		60.52 %
 top 5 validation accuracy:		82.50 %
Epoch 67 of 90 took 9.393m
  training loss:		1.003364
  validation loss:		1.925868
  validation accuracy:		60.36 %
 top 5 validation accuracy:		82.54 %
Epoch 68 of 90 took 9.390m
  training loss:		0.989146
  validation loss:		1.930862
  validation accuracy:		59.96 %
 top 5 validation accuracy:		82.44 %
Epoch 69 of 90 took 9.392m
  training loss:		0.974874
  validation loss:		1.920118
  validation accuracy:		60.26 %
 top 5 validation accuracy:		82.52 %
Epoch 70 of 90 took 9.389m
  training loss:		0.960957
  validation loss:		1.906879
  validation accuracy:		60.38 %
 top 5 validation accuracy:		82.44 %
New LR:0.000999999977648
Epoch 71 of 90 took 9.385m
  training loss:		0.952263
  validation loss:		1.915032
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.14 %
Epoch 72 of 90 took 9.393m
  training loss:		0.951050
  validation loss:		1.912515
  validation accuracy:		60.18 %
 top 5 validation accuracy:		82.38 %
Epoch 73 of 90 took 9.392m
  training loss:		0.949804
  validation loss:		1.911016
  validation accuracy:		59.98 %
 top 5 validation accuracy:		82.64 %
Epoch 74 of 90 took 9.393m
  training loss:		0.948175
  validation loss:		1.908804
  validation accuracy:		60.18 %
 top 5 validation accuracy:		82.50 %
Epoch 75 of 90 took 9.386m
  training loss:		0.946434
  validation loss:		1.911382
  validation accuracy:		60.34 %
 top 5 validation accuracy:		82.42 %
Epoch 76 of 90 took 9.384m
  training loss:		0.945349
  validation loss:		1.910831
  validation accuracy:		60.34 %
 top 5 validation accuracy:		82.50 %
Epoch 77 of 90 took 9.383m
  training loss:		0.943792
  validation loss:		1.909254
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.48 %
Epoch 78 of 90 took 9.391m
  training loss:		0.942635
  validation loss:		1.914427
  validation accuracy:		60.06 %
 top 5 validation accuracy:		82.54 %
Epoch 79 of 90 took 9.390m
  training loss:		0.941163
  validation loss:		1.915160
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.64 %
Epoch 80 of 90 took 9.391m
  training loss:		0.939693
  validation loss:		1.915712
  validation accuracy:		60.30 %
 top 5 validation accuracy:		82.52 %
Epoch 81 of 90 took 9.387m
  training loss:		0.938610
  validation loss:		1.914235
  validation accuracy:		60.10 %
 top 5 validation accuracy:		82.54 %
Epoch 82 of 90 took 9.393m
  training loss:		0.937135
  validation loss:		1.912549
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.58 %
Epoch 83 of 90 took 9.385m
  training loss:		0.935932
  validation loss:		1.908899
  validation accuracy:		60.52 %
 top 5 validation accuracy:		82.64 %
Epoch 84 of 90 took 9.386m
  training loss:		0.934404
  validation loss:		1.907856
  validation accuracy:		60.26 %
 top 5 validation accuracy:		82.42 %
Epoch 85 of 90 took 9.388m
  training loss:		0.932988
  validation loss:		1.906501
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.44 %
Epoch 86 of 90 took 9.388m
  training loss:		0.931663
  validation loss:		1.908466
  validation accuracy:		60.52 %
 top 5 validation accuracy:		82.58 %
Epoch 87 of 90 took 9.393m
  training loss:		0.930153
  validation loss:		1.908312
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.58 %
Epoch 88 of 90 took 9.392m
  training loss:		0.928883
  validation loss:		1.908977
  validation accuracy:		60.24 %
 top 5 validation accuracy:		82.64 %
Epoch 89 of 90 took 9.392m
  training loss:		0.927402
  validation loss:		1.905890
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.62 %
Epoch 90 of 90 took 9.391m
  training loss:		0.926189
  validation loss:		1.901364
  validation accuracy:		60.20 %
 top 5 validation accuracy:		82.54 %
Total training time: 846.313m
Final results:
  test loss:			1.903756
  test accuracy:		60.16 %
