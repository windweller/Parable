Using gpu device 0: GRID K520 (CNMeM is enabled)
/home/ubuntu/.local/lib/python2.7/site-packages/theano/tensor/signal/downsample.py:5: UserWarning: downsample module has been moved to the pool module.
  warnings.warn("downsample module has been moved to the pool module.")
Loading data...
loading training data for synset 20 / 100
loading training data for synset 40 / 100
loading training data for synset 60 / 100
loading training data for synset 80 / 100
loading training data for synset 100 / 100
Building model and compiling functions...
ResNet
number of parameters in model: 21154468
Starting training...
Epoch 1 of 90 took 14.529m
  training loss:		7.067288
  validation loss:		3.730003
  validation accuracy:		15.66 %
 top 5 validation accuracy:		39.10 %
Epoch 2 of 90 took 14.541m
  training loss:		5.579736
  validation loss:		3.250976
  validation accuracy:		22.16 %
 top 5 validation accuracy:		50.62 %
Epoch 3 of 90 took 14.541m
  training loss:		4.950780
  validation loss:		2.924191
  validation accuracy:		29.68 %
 top 5 validation accuracy:		57.70 %
Epoch 4 of 90 took 14.538m
  training loss:		4.476969
  validation loss:		2.781683
  validation accuracy:		32.26 %
 top 5 validation accuracy:		61.24 %
Epoch 5 of 90 took 14.527m
  training loss:		4.111975
  validation loss:		2.821957
  validation accuracy:		32.16 %
 top 5 validation accuracy:		60.10 %
New LR:0.0980000014603
Epoch 6 of 90 took 14.522m
  training loss:		3.801173
  validation loss:		2.730139
  validation accuracy:		34.38 %
 top 5 validation accuracy:		63.08 %
Epoch 7 of 90 took 14.538m
  training loss:		3.545379
  validation loss:		2.600353
  validation accuracy:		36.54 %
 top 5 validation accuracy:		65.66 %
Epoch 8 of 90 took 14.537m
  training loss:		3.314821
  validation loss:		2.462007
  validation accuracy:		39.12 %
 top 5 validation accuracy:		68.58 %
Epoch 9 of 90 took 14.541m
  training loss:		3.124884
  validation loss:		2.429845
  validation accuracy:		40.10 %
 top 5 validation accuracy:		68.36 %
Epoch 10 of 90 took 14.525m
  training loss:		2.962421
  validation loss:		2.364311
  validation accuracy:		41.78 %
 top 5 validation accuracy:		69.76 %
Epoch 11 of 90 took 14.533m
  training loss:		2.812654
  validation loss:		2.302420
  validation accuracy:		43.86 %
 top 5 validation accuracy:		71.68 %
Epoch 12 of 90 took 14.514m
  training loss:		2.689208
  validation loss:		2.289052
  validation accuracy:		43.82 %
 top 5 validation accuracy:		71.84 %
New LR:0.0960400047898
Epoch 13 of 90 took 14.522m
  training loss:		2.578016
  validation loss:		2.371321
  validation accuracy:		43.74 %
 top 5 validation accuracy:		71.54 %
New LR:0.0941192029417
Epoch 14 of 90 took 14.521m
  training loss:		2.482806
  validation loss:		2.316101
  validation accuracy:		44.70 %
 top 5 validation accuracy:		72.16 %
Epoch 15 of 90 took 14.517m
  training loss:		2.406119
  validation loss:		2.347711
  validation accuracy:		44.12 %
 top 5 validation accuracy:		71.46 %
New LR:0.0922368219495
Epoch 16 of 90 took 14.518m
  training loss:		2.324830
  validation loss:		2.269629
  validation accuracy:		46.42 %
 top 5 validation accuracy:		73.40 %
Epoch 17 of 90 took 14.524m
  training loss:		2.289043
  validation loss:		2.399643
  validation accuracy:		45.36 %
 top 5 validation accuracy:		73.10 %
New LR:0.090392087847
Epoch 18 of 90 took 14.519m
  training loss:		2.216276
  validation loss:		2.729303
  validation accuracy:		40.92 %
 top 5 validation accuracy:		69.10 %
New LR:0.0885842485726
Epoch 19 of 90 took 14.517m
  training loss:		2.159359
  validation loss:		2.469485
  validation accuracy:		44.86 %
 top 5 validation accuracy:		72.86 %
New LR:0.0868125666678
Epoch 20 of 90 took 14.518m
  training loss:		2.115698
  validation loss:		2.446692
  validation accuracy:		45.46 %
 top 5 validation accuracy:		72.28 %
New LR:0.0850763119757
Epoch 21 of 90 took 14.522m
  training loss:		2.064030
  validation loss:		2.448752
  validation accuracy:		46.84 %
 top 5 validation accuracy:		73.74 %
New LR:0.0833747835457
Epoch 22 of 90 took 14.522m
  training loss:		2.015822
  validation loss:		2.409729
  validation accuracy:		47.12 %
 top 5 validation accuracy:		74.58 %
New LR:0.0817072877288
Epoch 23 of 90 took 14.523m
  training loss:		1.967948
  validation loss:		2.520074
  validation accuracy:		46.64 %
 top 5 validation accuracy:		73.72 %
New LR:0.080073145479
Epoch 24 of 90 took 14.520m
  training loss:		1.932972
  validation loss:		2.642507
  validation accuracy:		46.82 %
 top 5 validation accuracy:		73.18 %
New LR:0.0784716850519
Epoch 25 of 90 took 14.522m
  training loss:		1.889846
  validation loss:		2.652050
  validation accuracy:		46.58 %
 top 5 validation accuracy:		73.56 %
New LR:0.0769022493064
Epoch 26 of 90 took 14.523m
  training loss:		1.853890
  validation loss:		2.687015
  validation accuracy:		46.16 %
 top 5 validation accuracy:		72.72 %
New LR:0.075364203006
Epoch 27 of 90 took 14.523m
  training loss:		1.834143
  validation loss:		2.718109
  validation accuracy:		46.74 %
 top 5 validation accuracy:		73.24 %
New LR:0.0738569182158
Epoch 28 of 90 took 14.515m
  training loss:		1.814906
  validation loss:		2.675446
  validation accuracy:		48.38 %
 top 5 validation accuracy:		74.70 %
Epoch 29 of 90 took 14.518m
  training loss:		1.767094
  validation loss:		2.829170
  validation accuracy:		46.08 %
 top 5 validation accuracy:		72.90 %
New LR:0.0723797816038
Epoch 30 of 90 took 14.524m
  training loss:		1.740939
  validation loss:		2.844144
  validation accuracy:		47.34 %
 top 5 validation accuracy:		72.30 %
New LR:0.07093218714
Epoch 31 of 90 took 14.524m
  training loss:		1.723455
  validation loss:		2.729623
  validation accuracy:		49.46 %
 top 5 validation accuracy:		75.70 %
Epoch 32 of 90 took 14.521m
  training loss:		1.692925
  validation loss:		2.817990
  validation accuracy:		48.90 %
 top 5 validation accuracy:		74.08 %
New LR:0.0695135433972
Epoch 33 of 90 took 14.519m
  training loss:		1.685001
  validation loss:		2.728354
  validation accuracy:		48.96 %
 top 5 validation accuracy:		74.54 %
New LR:0.0681232735515
Epoch 34 of 90 took 14.521m
  training loss:		1.625851
  validation loss:		2.841123
  validation accuracy:		48.52 %
 top 5 validation accuracy:		73.14 %
New LR:0.0667608080804
Epoch 35 of 90 took 14.521m
  training loss:		1.596010
  validation loss:		2.977842
  validation accuracy:		46.02 %
 top 5 validation accuracy:		71.64 %
New LR:0.0654255920649
Epoch 36 of 90 took 14.519m
  training loss:		1.590448
  validation loss:		2.876765
  validation accuracy:		47.70 %
 top 5 validation accuracy:		73.06 %
New LR:0.0641170778871
Epoch 37 of 90 took 14.522m
  training loss:		1.553901
  validation loss:		2.970888
  validation accuracy:		47.48 %
 top 5 validation accuracy:		73.22 %
New LR:0.0628347398341
Epoch 38 of 90 took 14.515m
  training loss:		1.511384
  validation loss:		2.928932
  validation accuracy:		48.80 %
 top 5 validation accuracy:		73.24 %
New LR:0.0615780448914
Epoch 39 of 90 took 14.519m
  training loss:		1.466639
  validation loss:		2.952882
  validation accuracy:		48.88 %
 top 5 validation accuracy:		73.80 %
New LR:0.0603464855999
Epoch 40 of 90 took 14.518m
  training loss:		1.441062
  validation loss:		2.871825
  validation accuracy:		48.82 %
 top 5 validation accuracy:		74.44 %
New LR:0.0591395545006
Epoch 41 of 90 took 14.523m
  training loss:		1.422000
  validation loss:		2.930737
  validation accuracy:		48.88 %
 top 5 validation accuracy:		73.94 %
New LR:0.0579567623883
Epoch 42 of 90 took 14.520m
  training loss:		1.388683
  validation loss:		2.905542
  validation accuracy:		49.60 %
 top 5 validation accuracy:		74.60 %
New LR:0.0567976273596
Epoch 43 of 90 took 14.518m
  training loss:		1.350011
  validation loss:		2.767243
  validation accuracy:		51.00 %
 top 5 validation accuracy:		75.40 %
Epoch 44 of 90 took 14.516m
  training loss:		1.331236
  validation loss:		2.965732
  validation accuracy:		49.00 %
 top 5 validation accuracy:		73.86 %
New LR:0.0556616748124
Epoch 45 of 90 took 14.520m
  training loss:		1.335497
  validation loss:		2.988010
  validation accuracy:		48.08 %
 top 5 validation accuracy:		73.52 %
New LR:0.0545484410971
Epoch 46 of 90 took 14.520m
  training loss:		1.311636
  validation loss:		2.922346
  validation accuracy:		49.08 %
 top 5 validation accuracy:		73.40 %
New LR:0.0534574735165
Epoch 47 of 90 took 14.521m
  training loss:		1.286097
  validation loss:		2.819380
  validation accuracy:		49.86 %
 top 5 validation accuracy:		74.94 %
New LR:0.0523883230239
Epoch 48 of 90 took 14.523m
  training loss:		1.261822
  validation loss:		2.887600
  validation accuracy:		49.68 %
 top 5 validation accuracy:		74.22 %
New LR:0.0513405551761
Epoch 49 of 90 took 14.519m
  training loss:		1.213575
  validation loss:		2.866323
  validation accuracy:		50.98 %
 top 5 validation accuracy:		75.40 %
New LR:0.0503137428313
Epoch 50 of 90 took 14.518m
  training loss:		1.187291
  validation loss:		2.796116
  validation accuracy:		50.58 %
 top 5 validation accuracy:		74.48 %
New LR:0.0493074661493
Epoch 51 of 90 took 14.519m
  training loss:		1.163358
  validation loss:		2.830493
  validation accuracy:		51.08 %
 top 5 validation accuracy:		74.92 %
New LR:0.0483213162422
Epoch 52 of 90 took 14.517m
  training loss:		1.137467
  validation loss:		2.788729
  validation accuracy:		51.12 %
 top 5 validation accuracy:		75.36 %
New LR:0.0473548915237
Epoch 53 of 90 took 14.522m
  training loss:		1.107779
  validation loss:		2.731984
  validation accuracy:		51.04 %
 top 5 validation accuracy:		75.46 %
New LR:0.0464077940583
Epoch 54 of 90 took 14.525m
  training loss:		1.071685
  validation loss:		2.819287
  validation accuracy:		52.10 %
 top 5 validation accuracy:		75.22 %
Epoch 55 of 90 took 14.526m
  training loss:		1.054121
  validation loss:		2.892254
  validation accuracy:		50.12 %
 top 5 validation accuracy:		74.82 %
New LR:0.0454796368629
Epoch 56 of 90 took 14.518m
  training loss:		1.069588
  validation loss:		2.879739
  validation accuracy:		49.82 %
 top 5 validation accuracy:		74.52 %
New LR:0.0445700439066
Epoch 57 of 90 took 14.520m
  training loss:		1.054663
  validation loss:		2.792379
  validation accuracy:		50.38 %
 top 5 validation accuracy:		75.30 %
New LR:0.0436786428094
Epoch 58 of 90 took 14.517m
  training loss:		1.018842
  validation loss:		2.808644
  validation accuracy:		51.02 %
 top 5 validation accuracy:		75.74 %
New LR:0.0428050684929
Epoch 59 of 90 took 14.522m
  training loss:		1.009020
  validation loss:		2.845055
  validation accuracy:		50.30 %
 top 5 validation accuracy:		74.34 %
New LR:0.041948966831
Epoch 60 of 90 took 14.522m
  training loss:		0.990089
  validation loss:		2.776489
  validation accuracy:		51.94 %
 top 5 validation accuracy:		75.14 %
New LR:0.0411099873483
Epoch 61 of 90 took 14.523m
  training loss:		0.948261
  validation loss:		2.760942
  validation accuracy:		50.92 %
 top 5 validation accuracy:		75.54 %
New LR:0.00411099866033
New LR:0.00402877850458
Epoch 62 of 90 took 14.515m
  training loss:		0.894143
  validation loss:		2.407310
  validation accuracy:		56.28 %
 top 5 validation accuracy:		78.68 %
Epoch 63 of 90 took 14.521m
  training loss:		0.857181
  validation loss:		2.380024
  validation accuracy:		56.74 %
 top 5 validation accuracy:		78.86 %
New LR:0.00394820295274
Epoch 64 of 90 took 14.519m
  training loss:		0.846577
  validation loss:		2.373883
  validation accuracy:		56.96 %
 top 5 validation accuracy:		79.20 %
New LR:0.00386923876591
Epoch 65 of 90 took 14.518m
  training loss:		0.839005
  validation loss:		2.349462
  validation accuracy:		57.28 %
 top 5 validation accuracy:		79.22 %
New LR:0.00379185399972
Epoch 66 of 90 took 14.518m
  training loss:		0.832122
  validation loss:		2.330372
  validation accuracy:		57.32 %
 top 5 validation accuracy:		79.60 %
New LR:0.00371601693798
Epoch 67 of 90 took 14.524m
  training loss:		0.826455
  validation loss:		2.328368
  validation accuracy:		57.26 %
 top 5 validation accuracy:		79.38 %
New LR:0.00364169654902
Epoch 68 of 90 took 14.521m
  training loss:		0.820839
  validation loss:		2.316588
  validation accuracy:		57.28 %
 top 5 validation accuracy:		79.34 %
New LR:0.00356886271387
Epoch 69 of 90 took 14.523m
  training loss:		0.816294
  validation loss:		2.312961
  validation accuracy:		57.44 %
 top 5 validation accuracy:		79.44 %
New LR:0.00349748554174
Epoch 70 of 90 took 14.523m
  training loss:		0.811254
  validation loss:		2.302019
  validation accuracy:		57.54 %
 top 5 validation accuracy:		79.42 %
New LR:0.00342753582634
Epoch 71 of 90 took 14.523m
  training loss:		0.806810
  validation loss:		2.306080
  validation accuracy:		57.62 %
 top 5 validation accuracy:		79.50 %
New LR:0.00335898504592
Epoch 72 of 90 took 14.518m
  training loss:		0.802000
  validation loss:		2.297320
  validation accuracy:		57.72 %
 top 5 validation accuracy:		79.56 %
New LR:0.00329180536326
Epoch 73 of 90 took 14.520m
  training loss:		0.798024
  validation loss:		2.290080
  validation accuracy:		57.68 %
 top 5 validation accuracy:		79.46 %
New LR:0.00322596916929
Epoch 74 of 90 took 14.523m
  training loss:		0.793505
  validation loss:		2.285143
  validation accuracy:		57.74 %
 top 5 validation accuracy:		79.48 %
New LR:0.00316144976765
Epoch 75 of 90 took 14.520m
  training loss:		0.789552
  validation loss:		2.280527
  validation accuracy:		57.72 %
 top 5 validation accuracy:		79.72 %
New LR:0.000316144968383
New LR:0.000309822057607
Epoch 76 of 90 took 14.519m
  training loss:		0.787422
  validation loss:		2.268052
  validation accuracy:		57.94 %
 top 5 validation accuracy:		79.54 %
New LR:0.000303625621018
Epoch 77 of 90 took 14.521m
  training loss:		0.786967
  validation loss:		2.265551
  validation accuracy:		57.90 %
 top 5 validation accuracy:		79.64 %
New LR:0.00029755311145
Epoch 78 of 90 took 14.526m
  training loss:		0.786709
  validation loss:		2.268610
  validation accuracy:		57.76 %
 top 5 validation accuracy:		79.52 %
New LR:0.00029160204751
Epoch 79 of 90 took 14.541m
  training loss:		0.786188
  validation loss:		2.274857
  validation accuracy:		57.88 %
 top 5 validation accuracy:		79.64 %
New LR:0.000285770004848
Epoch 80 of 90 took 14.545m
  training loss:		0.785820
  validation loss:		2.275737
  validation accuracy:		57.62 %
 top 5 validation accuracy:		79.68 %
New LR:0.00028005461616
Epoch 81 of 90 took 14.542m
  training loss:		0.785463
  validation loss:		2.279310
  validation accuracy:		57.82 %
 top 5 validation accuracy:		79.50 %
New LR:0.000274453514139
Epoch 82 of 90 took 14.547m
  training loss:		0.785145
  validation loss:		2.269673
  validation accuracy:		58.08 %
 top 5 validation accuracy:		79.84 %
New LR:0.000268964445568
Epoch 83 of 90 took 14.546m
  training loss:		0.784964
  validation loss:		2.261817
  validation accuracy:		57.88 %
 top 5 validation accuracy:		79.80 %
New LR:0.000263585157227
Epoch 84 of 90 took 14.543m
  training loss:		0.784471
  validation loss:		2.280622
  validation accuracy:		57.74 %
 top 5 validation accuracy:		79.60 %
New LR:0.000258313452941
Epoch 85 of 90 took 14.544m
  training loss:		0.784313
  validation loss:		2.274628
  validation accuracy:		57.80 %
 top 5 validation accuracy:		79.82 %
New LR:0.00025314719358
Epoch 86 of 90 took 14.541m
  training loss:		0.783838
  validation loss:		2.263100
  validation accuracy:		57.98 %
 top 5 validation accuracy:		79.62 %
New LR:0.000248084240011
Epoch 87 of 90 took 14.524m
  training loss:		0.783520
  validation loss:		2.270291
  validation accuracy:		57.96 %
 top 5 validation accuracy:		79.80 %
New LR:0.00024312256719
Epoch 88 of 90 took 14.531m
  training loss:		0.783037
  validation loss:		2.265139
  validation accuracy:		57.70 %
 top 5 validation accuracy:		79.74 %
New LR:0.00023826012155
Epoch 89 of 90 took 14.529m
  training loss:		0.783142
  validation loss:		2.275684
  validation accuracy:		57.72 %
 top 5 validation accuracy:		79.70 %
New LR:0.000233494920831
Epoch 90 of 90 took 14.526m
  training loss:		0.782761
  validation loss:		2.274327
  validation accuracy:		57.70 %
 top 5 validation accuracy:		79.86 %
New LR:0.000228825025551
Total training time: 1308.548m
Traceback (most recent call last):
  File "cnn_resnet.py", line 520, in <module>
    main(num_epochs=epochs, **kwargs)
  File "cnn_resnet.py", line 481, in main
    err, acc = val_fn(inputs, targets)
ValueError: too many values to unpack
